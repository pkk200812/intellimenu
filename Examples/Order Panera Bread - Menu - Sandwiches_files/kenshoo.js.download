/*! kenshoo 0.0.1 2018-01-28 */

var KENSHOO_CLICK_ID_COOKIE_NAME="ken_kclid",CONVERSION_KCLID_PARAM_NAME="kclid",LANDING_PAGE_KCLID_PARAM_NAME="kclid",Kenshoo_Helpers=function(){var a=function(a){var b=new XMLHttpRequest;return"withCredentials"in b?b.open("GET",a,!0):"undefined"!=typeof XDomainRequest?(b=new XDomainRequest,b.open("GET",a)):b=null,b},b=function(a){return c("k_user_id",a)},c=function(a,b){if(b||(b=d()),a){var c=new Date;c.setTime(c.getTime()+31536e6);var e="; expires="+c.toGMTString();return document.cookie=a+"="+b+e+"; path=/",b}},d=function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return{loadPixel:function(a,b){var c=document.location.protocol;0!==c.indexOf("http")&&(c="https:");var d=new Image(1,1);return d.onload=b,d.src=c+"//"+a,d},getParameter:function(a,b){b||(b=window.location.href);var c=b.indexOf("?");if(-1==c)return null;for(var d=b.substring(c+1).split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0]===a)return f[1]}return null},generateUUID:function(){return d()},getCookie:function(c){var d=this.getParameter("k_user_id");if(d)return c(d);var e=this.getDomainCookie();if(e)return c(e);var f=a("https://services.xg4ken.com/kid");f&&(f.onload=function(){if(200==f.status){var a=f.responseText;b(a),c(a)}else 404==f.status&&(b(),c(null))},f.onerror=function(){b(),c(null)},f.send())},getDomainCookie:function(a){a||(a="k_user_id");for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},createDomainCookie:function(a,b,c,e){if(a){b||(b=d()),c||(c=31536e6);var f=new Date;f.setTime(f.getTime()+c);var g="; expires="+f.toGMTString(),h="";return e&&(h="; domain="+e),document.cookie=a+"="+b+g+h+"; path=/",b}},createRandomDomainCookie:function(a,b){return this.createDomainCookie(a,"",b)},paramsToString:function(a,b,c){var d=c||"",e="";if(null!==a){for(var f in a)""!==e&&(e+="&"),e+=d+f+"="+a[f];""!==e&&(e=b+e)}return e},isEmptyString:function(a){return void 0===a||null===a||(Kenshoo_Helpers.isString(a)?""===Kenshoo_Helpers.trim(a):!Kenshoo_Helpers.isNumber(a))},isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},findGroupForCookie:function(a,b){b||(b="");var d=this.getDomainCookie("k_rlsa");d||(d=c("k_rlsa")),d+="_"+b;for(var e=0,f=0;f<d.length;f++)e+=d.charCodeAt(f);e=Math.abs(e),a||(a=[1,1]);var g=0;for(f=0;f<a.length;f++)g+=1*a[f];var h=e%g,i=0;for(f=0;f<a.length;f++)if(i+=a[f],h<i){var j=String.fromCharCode(97+f);return j}return null},getDomain:function(){return window.location.host},getRandomNumber:function(a,b){return Math.floor(Math.random()*(b+1)+a)},makeCORSRequest:function(a,b){var c=new XMLHttpRequest;"withCredentials"in c?(c.open("GET",a,!0),c.withCredentials=!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open("GET",a)):c=null,c&&(c.onload=function(){200==c.status?b(c.responseText):404==c.status&&b(null)},c.onerror=function(){b(null)},c.send())},isValidUUID:function(a){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a)},getSecondLevelDomain:function(a){if(!a)return null;var b=["ac","ad","ae","aero","af","ag","ai","al","am","an","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","st","su","sv","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","travel","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","xn--0zwm56d","xn--11b5bs3a9aj6g","xn--3e0b707e","xn--45brj9c","xn--80akhbyknj4f","xn--90a3ac","xn--9t4b11yi5a","xn--clchc0ea0b2g2a9gcd","xn--deba0ad","xn--fiqs8s","xn--fiqz9s","xn--fpcrj9c3d","xn--fzc2c9e2c","xn--g6w251d","xn--gecrj9c","xn--h2brj9c","xn--hgbk6aj7f53bba","xn--hlcj6aya9esc7a","xn--j6w193g","xn--jxalpdlp","xn--kgbechtv","xn--kprw13d","xn--kpry57d","xn--lgbbat1ad8j","xn--mgbaam7a8h","xn--mgbayh7gpa","xn--mgbbh1a71e","xn--mgbc0a9azcg","xn--mgberp4a5d4ar","xn--o3cw4h","xn--ogbpf8fl","xn--p1ai","xn--pgbs0dh","xn--s9brj9c","xn--wgbh1c","xn--wgbl6a","xn--xkc2al3hye2a","xn--xkc2dl3a5ee0h","xn--yfro4i67o","xn--ygbi2ammx","xn--zckzah","xxx","ye","yt","za","zm","zw"].join(),c=a.split(".");"www"===c[0]&&"com"!==c[1]&&c.shift();for(var d,e=c.length,f=e,g=c[c.length-1].length;null!==(d=c[--f]);)if(0===f||f<e-2||d.length<g||b.indexOf(d)<0&&f<e-1)return c.slice(f,c.length).join(".");return a},createSecondLevelDomainCookie:function(a,b,c){if(a&&b){var d=this.getSecondLevelDomain(c);this.createDomainCookie(a,b,null,d)}}}}(),kenshoo=function(){var a=Kenshoo_Helpers,b=function(b,c){var d=b+".xg4ken.com/media/redir.php";d+=a.paramsToString(c,"?"),a.loadPixel(d)},c=function(b,c,d){var e=b+".xg4ken.com/pixel/v1?track=1&token="+c;e+=a.paramsToString(d,"&");var f=a.getDomainCookie(KENSHOO_CLICK_ID_COOKIE_NAME);f&&a.isValidUUID(f)&&(e+="&"+CONVERSION_KCLID_PARAM_NAME+"="+f),a.loadPixel(e)},d=function(b,c){var d="googleads.g.doubleclick.net/pagead/viewthroughconversion/"+b+"/?value=0&guid=ON&script=0";d+=a.paramsToString(c,"&","data."),d+="&random="+(new Date).getTime(),a.loadPixel(d)},e=function(a,b,c,d){var e=a[b];f(e,c,d)},f=function(b,c,d){if(b){var e="www.facebook.com/tr/?ev="+b;c&&(e+="&cd[value]="+c),d&&(e+="&cd[currency]="+d),e+="&noscript=1",a.loadPixel(e)}},g=function(){a.getCookie(function(c){var d=a.getParameter("ken_ks"),e=a.getParameter("ken_prf"),f=a.getParameter("ken_cid");c&&d&&e&&f&&b(d,{k_user_id:c,prof:e,affcode:f,url:"http://"+d+".xg4ken.com"})})};return{trackConversion:function(a,b,d){c(a,b,d)},trackClick:function(){g()},trackRLSA:function(a,b){d(a,b)},trackRLSAExperiment:function(b,c,e){var f=a.findGroupForCookie(e,c);b&&c&&null!==f&&d(b,{kenshoo_experiment:c,kenshoo_group:f})},trackOCPM:function(a,b,c){f(a,b,c)},trackOCPMWithConversionTypeMapping:function(a,b,c,d){e(a,b,c,d)},match:function(a){Uds_Pixel.matchAndSync(a)},trackEvent:function(a,b,c,d){a&&b&&c&&"landingPage"===a&&LP_Pixel.storeKenshooId()}}}(),LP_Pixel=function(){var a=Kenshoo_Helpers,b=function(b,c){var d=a.getParameter(b);d&&a.isValidUUID(d)&&(a.getDomainCookie(c)||a.createSecondLevelDomainCookie(c,d,document.domain))};return{storeKenshooId:function(a){a||(a=LANDING_PAGE_KCLID_PARAM_NAME),b(a,KENSHOO_CLICK_ID_COOKIE_NAME)}}}(),Uds_Pixel=function(){var a=Kenshoo_Helpers,b="https://services.xg4ken.com/kid?client_domain=".concat(a.getDomain()),c=function(c){(User_Match.shouldPerformMatch(c)||User_Sync.shouldPerformSync())&&a.makeCORSRequest(b,function(a){User_Match.match(c,a),User_Sync.sync(a)})};return{matchAndSync:function(a){c(a)}}}(),MATCH_COOKIE_NAME="kenshoo_id_match",User_Match=function(){var a=Kenshoo_Helpers,b=function(a,b,c){return"services.xg4ken.com/services/uds/match?source="+a+"&ken_id="+b+"&partner_uid="+c+"&hmac="};return{match:function(c,d){if(this.shouldPerformMatch(c)&&!a.isEmptyString(d)){var e=b(a.getDomain(),d,c);a.loadPixel(e,function(){a.createRandomDomainCookie(MATCH_COOKIE_NAME,6048e5)})}},shouldPerformMatch:function(b){return a.isEmptyString(a.getDomainCookie(MATCH_COOKIE_NAME))&&!a.isEmptyString(b)}}}(),RAND_URL_PARAM="&_rand=",User_Sync=function(){var a=Kenshoo_Helpers,b={prefix:"cw.addthis.com/t.gif?pid=50&pdid=",syncCookieName:"kenshoo_crosswise_id_sync",cookieExpiry:864e5},c=[b],d=function(a,b,c){return a+b+RAND_URL_PARAM+c},e=function(b){return a.isEmptyString(a.getDomainCookie(b))},f=function(b,c){if(e(b.syncCookieName)){var f=a.getRandomNumber(1,1e4),g=d(b.prefix,c,f);a.loadPixel(g,function(){a.createRandomDomainCookie(b.syncCookieName,b.cookieExpiry)})}};return{sync:function(a){for(var b=0;b<c.length;b++)f(c[b],a)},shouldPerformSync:function(){for(var a=0;a<c.length;a++)if(e(c[a].syncCookieName))return!0;return!1}}}();
//# sourceMappingURL=kenshoo.js.map